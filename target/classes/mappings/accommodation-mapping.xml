<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="AccommodationMapper">
	<!-- 지역으로 숙소 검색 -->
	<select id="selectAccByAdd" resultType="accommodation">
		SELECT * FROM accommodation
		WHERE address like '%'||#{address}||'%'
	</select>
	
	<!-- 전체 숙소 조회 -->
	<select id="listAcc" resultType="accommodation">
		SELECT * FROM accommodation ORDER BY aseq
	</select>
	
	<!-- 숙소 갯수 조회 -->
	<select id="countAccList" parameterType="String" resultType="int">
		SELECT count(*) FROM accommodation WHERE address like '%'||#{address}||'%'
	</select>
	
	<!-- 페이지별 숙소 목록 조회 -->
	<select id="listAccWithPaging" resultType="accommodation">
		<![CDATA[
		SELECT * FROM
		(SELECT row_number() OVER (ORDER BY name) rn, email, name, category, address, tel, bestyn, image1, image2, image3, image4, image5
		FROM accommodation WHERE address like '%'||#{address}||'%')
		WHERE rn <= #{criteria.pageNum} * #{criteria.rowsPerPage}
		AND rn > (#{criteria.pageNum}-1) * #{criteria.rowsPerPage}
		]]>
	</select>
	
	<!-- host 숙소 -->
	<select id="listHostAccommodation" resultType="accommodation">
		SELECT * FROM accommodation
		WHERE email=#{email}
	</select>
</mapper>
